<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="dev.mvc.favorite.FavoriteDAOInter">

  <!-- 즐겨찾기 추가 -->
  <insert id="create" parameterType="dev.mvc.favorite.FavoriteVO">
    INSERT INTO favorite(favoriteno, restno, custno)
    VALUES(favorite_seq.nextval, #{restno}, #{custno})
  </insert>

  <!-- 즐겨찾기 제거 -->
  <delete id="delete" parameterType="dev.mvc.favorite.FavoriteVO">
    DELETE FROM favorite
    WHERE favoriteno = #{favoriteno}
  </delete>

  <!-- 즐겨찾기 목록 조회 -->
  <select id="favorite_list" resultType="dev.mvc.favorite.FavoriteVO">
      SELECT f.favoriteno, f.restno, f.custno, r.name AS restname
      FROM favorite f
      JOIN RESTAURANT r ON f.restno = r.restno
      ORDER BY f.favoriteno ASC
  </select>
  
    <select id="list_by_custno" parameterType="int" resultType="dev.mvc.favorite.FavoriteVO">
      SELECT * FROM favorite WHERE custno = #{custno}
  </select>
  
      <!-- 특정 사용자가 특정 식당을 이미 즐겨찾기했는지 확인 -->
    <select id="isFavorited" parameterType="map" resultType="int">
        SELECT COUNT(*)
        FROM favorite
        WHERE custno = #{custno} AND restno = #{restno}
    </select>


</mapper>
