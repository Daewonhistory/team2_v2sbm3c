<?xml version="1.0" encoding="UTF-8"?>
 
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="dev.mvc.review.ReviewDAOInter">
  
  <!-- return 값(int: 1),  리뷰 작성-->
  <insert id="create" parameterType="dev.mvc.review.ReviewVO">
    INSERT INTO Review(reviewno, title, content, rate, rdate, custno, restno)
    VALUES (review_seq.nextval, #{title}, #{content}, #{rate}, sysdate, #{custno}, #{restno})
  </insert>

  <!-- 일반적인 조회 -->
  <select id="read" resultType="dev.mvc.review.ReviewVO" parameterType="int">
    SELECT reviewno, title, content, rate, rdate, custno, restno
    FROM review
    WHERE reviewno = #{reviewno}
  </select>
  
    <!-- 리뷰 삭제 -->
  <delete id="delete_review" parameterType="int">
    DELETE FROM review
    WHERE reviewno = #{reviewno}
  </delete>
  
  <!-- 리뷰 수정 -->
  <update id="update_review" parameterType="dev.mvc.review.ReviewVO">
    UPDATE review
    set content = #{content}, title=#{title}, rate=#{rate}
    WHERE reviewno = #{reviewno}
  </update>
  
  <select id="list_all" resultType="dev.mvc.review.ReviewVO">
    SELECT reviewno, title, content, rate, rdate, custno, restno
    FROM review
    ORDER BY reviewno ASC
  </select>
   
  <select id="list_by_custno_count" resultType="int" parameterType="int">
    SELECT COUNT(*)
    FROM review
    WHERE custno = #{custno}
  </select>
  
  <select id="list_by_restno_count" resultType="int" parameterType="int">
    SELECT COUNT(*)
    FROM review
    WHERE restno = #{restno}
  </select>
   
   
</mapper> 