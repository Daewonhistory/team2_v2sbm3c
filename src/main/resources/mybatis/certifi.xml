<?xml version="1.0" encoding="UTF-8"?>


<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="dev.mvc.certifi.CertifiDAOInter">


     <!--   사업자 등록증 신분증 등록-->
    <insert id="createCertifi" parameterType="dev.mvc.owner.OwnerVO">
        INSERT INTO certifi(certifino, ownerno, businessno, certifi_image,identi_card_image
                          ,reg_date)
        VALUES (certifi_seq.nextval, #{ownerno}, #{businessno}, #{certifi_image}, #{identi_card_image},
                 sysdate)
    </insert>
    <!--  사업자 신분증,등록증 조회-->
    <select id="findByOnwer"  parameterType="int">
        SELECT businessno, certifi_image, identi_card_image, reg_date
        FROM certifi
        WHERE ownerno = #{ownerno}

    </select>


    <select id="list_search_paging" parameterType="java.util.Map" resultType="dev.mvc.certifi.CertifiVO">

        <if test="word == null or word == ''">
            <!-- 전체 결과를 가져오는 쿼리 -->
            <![CDATA[
        SELECT categoryno, name, r
        FROM (
                 SELECT categoryno, name, ROWNUM as r
                 FROM (
                          SELECT categoryno, name
                          FROM category

                      )
                 WHERE ROWNUM <= #{end_num}
             )
        WHERE r >= #{start_num} ]]>
        </if>
        <if test="word != null and word != ''">
            <!-- name으로 조회 -->
            <![CDATA[
        SELECT categoryno, name, r
        FROM (
                 SELECT categoryno, name, ROWNUM as r
                 FROM (
                          SELECT categoryno, name
                          FROM category
                          WHERE name LIKE '%' || #{word} || '%'

                      )
                 WHERE ROWNUM <= #{end_num}
             )
        WHERE r >= #{start_num} ]]>
        </if>

    </select>




    <select id="list_search_count" parameterType="java.util.Map" resultType="int">
        <if test="word == null or word == ''">
            <!-- 전체 결과를 가져오는 쿼리 -->
            SELECT count(*) as cnt
            FROM category

        </if>
        <if test="word != null and word != ''">
            <!-- name으로 조회 -->
            SELECT count(*) as cnt
            FROM category
            WHERE name LIKE '%' || #{word} || '%'

        </if>
    </select>

    <select id="businessnoList">
        select businessno
        from certifi
        where ownerno = #{ownerno}
    </select>

</mapper>