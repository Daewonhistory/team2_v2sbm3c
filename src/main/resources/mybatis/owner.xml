<?xml version="1.0" encoding="UTF-8"?>


<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="dev.mvc.owner.OwnerDAOInter">
    <select id="checkID" resultType="int" parameterType="String">
        SELECT COUNT(id) as cnt
        FROM owner
        WHERE id=#{id}
    </select>




    <insert id="create" parameterType="dev.mvc.owner.OwnerVO">
        INSERT INTO owner(ownerno, id, passwd, oname,phone,tel, address1, address2, grade,
                            image,reg_date)
        VALUES (owner_seq.nextval, #{id}, #{passwd}, #{oname}, #{phone},
                #{tel}, #{address1}, #{address2},  #{grade}, #{image}, sysdate)
    </insert>

    <select id="list" resultType="dev.mvc.owner.OwnerVO">
        SELECT ownerno, id, passwd, oname, tel, phone, address1, address2, reg_date, grade
        FROM owner
        ORDER BY grade ASC, id ASC
    </select>

<!--    &lt;!&ndash; ownerno로 회원 정보 조회 &ndash;&gt;-->
    <select id="read" resultType="dev.mvc.owner.OwnerVO" parameterType="int">
        SELECT ownerno, id, passwd, oname, tel,phone , address1, address2, reg_date, grade
        FROM owner
        WHERE ownerno = #{ownerno}
    </select>

    <!-- id(이메일)로 회원 정보 조회 -->
    <select id="readById" resultType="dev.mvc.owner.OwnerVO" parameterType="String">
        SELECT ownerno, id, passwd, oname, tel,phone , address1, address2, reg_date, grade
        FROM owner
        WHERE id = #{id}
    </select>

    <update id="update" parameterType="dev.mvc.owner.OwnerVO">
        UPDATE owner
        SET  oname=#{oname}, phone=#{phone}, address1=#{address1}, address2=#{address2}
        WHERE id=#{id}
    </update>

<!--    <delete id="delete" parameterType="int">-->
<!--        update owner set  grade=99-->
<!--        WHERE ownerno=#{ownerno}-->
<!--    </delete>-->

<!--    &lt;!&ndash; 로그인 &ndash;&gt;-->
    <select id="login" resultType="int" parameterType="HashMap">
    <![CDATA[
        SELECT COUNT(ownerno) as cnt
        FROM owner
        WHERE id = #{id}
          AND passwd = #{passwd}
          AND grade <> 99
        ]]>
    </select>

    <!--  현재 패스워드 검사 -->
    <select id="passwd_check" parameterType="HashMap" resultType="int">
        SELECT COUNT(ownerno) as cnt
        FROM owner
        WHERE ownerno=#{ownerno} AND passwd=#{passwd}
    </select>

    <!-- 패스워드 변경 -->
    <update id="passwd_update" parameterType="HashMap">
        UPDATE owner
        SET passwd=#{passwd}
        WHERE ownerno=#{ownerno}
    </update>

    <update id="update_grade" >
        UPDATE owner
        SET grade=#{grade}
        WHERE ownerno=#{ownerno}
    </update>


    <insert id="createCertifi" parameterType="dev.mvc.owner.OwnerVO">
        INSERT INTO CERTIFI(CERTIFINO, ownerno, businessno, certifi_image,identi_card_image
                          ,reg_date)
        VALUES (certifi_seq.nextval, #{ownerno}, #{businessno}, #{certifi_image}, #{identi_card_image},
                 sysdate)
    </insert>

<!--    <select id="list_by_cateno" resultType="dev.mvc.contents.ContentsVO" parameterType="int">-->
<!--        SELECT contentsno, adminno, cateno, title, content, recom, cnt, replycnt, rdate,-->
<!--               file1, file1saved, thumb1, size1, mp4-->
<!--        FROM contents-->
<!--        WHERE cateno = #{cateno}-->
<!--        ORDER BY contentsno DESC-->
<!--    </select>-->
</mapper>