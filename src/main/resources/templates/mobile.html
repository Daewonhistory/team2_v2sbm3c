<!DOCTYPE html>
<html layout:decorate="~{mobile_layout}">
<div layout:fragment="content">
	<section id="home" style="height: 400px">
		<script th:inline="javascript">
			if ([[${logout}]]) {
				alert([[${logout}]]);
			}
		</script>
        <div class="slider" id="slider">
		  <div class="slide"><img src="/main/storage/hansikdang.png" alt="Slide 1"></div>
		  <div class="slide"><img src="/main/storage/중식당.png" alt="Slide 2"></div>
		  <div class="slide"><img src="/main/storage/양식당.png" alt="Slide 3"></div>
		  <!-- Add more slides as needed -->
		  <button class="arrow left" id="prev">&lt;</button>
		  <button class="arrow right" id="next">&gt;</button>
		</div>
		<div style="height: 15%;display: flex;justify-content: center;align-items: center;">
			<div class="radio_buttons" id="radio_buttons"></div>
		</div>
			
    </section>
    <section id="cate_shortcut_section" style="display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;">
        <h2>카테고리 숏컷</h2>
    	<table class="table table-hover" style="height: 100px">
		    <colgroup>
		      <col style='width: 20%;'/>
		      <col style='width: 20%;'/>
		      <col style='width: 20%;'/>
		      <col style='width: 20%;'/>    
		      <col style='width: 20%;'/>
		    </colgroup>
		    <tbody th:each="categoryVO, status : ${categoryList}" th:with="index=${status.index}, rowIndex=${index / 5}" style="height: 50%">
		    	<tr th:if="${index % 5 == 0}" style="height: 30%">
		    		<td th:each="i : ${#numbers.sequence(0, 4)}" 
            th:if="${index + i < categoryList.size()}" 
            th:text="${categoryList[index + i].name}" th:onclick="|selectCategory(${categoryList[index + i].categoryno})|"></td>
		    	</tr>
					<tr th:if="${categoryVO.image != null and (categoryVO.image.endsWith('jpg') or categoryVO.image.endsWith('JPG') or categoryVO.image.endsWith('png') or categoryVO.image.endsWith('PNG') or categoryVO.image.endsWith('gif'))}">
						<!--/*@thymesVar id="certifi_image" type=""*/-->
						<img th:src="@{|/category/storage/${categoryVO.image}|}" style="width: 50px; height: 50px;" >
					</tr>
		    </tbody>
        </table>
    </section>


	<section id="loca_shortcut_section">
        <h2>위치기반 숏컷</h2>
        <div id="midarea_div" >
					<button class="button"
									type="button"
									th:each="midAreaVO, status : ${midAreaList}"
									th:value="${midAreaVO.midareano}"
									th:text="${midAreaVO.name}"
									onclick="selectMidArea(this)"
									>
					</button>
				</div>
				<!--
		<script>
			$(document).ready(function() {
				$(".button").click(function() {


					if ($(this).hasClass("active")) {
						$(".button_selected").removeClass('button_selected')
					} else {
						$(".button_selected").removeClass('button_selected')

						$(this).addClass('button_selected')
					}

				})
			})
		</script>
        -->
        <div id="botarea_div" style="display:none; margin-top: 30px;">
        	
        </div>
    </section>
    <section id="section_best" >
        <h2>최고 인기 순위 식당</h2>
			<div id="wrap-horizontal">
				<div th:each="restFullData, iterStat : ${restFullData}" class="image-container">
					<div th:if="${restFullData.image1 != null and (restFullData.image1.endsWith('jpg') or restFullData.image1.endsWith('JPG') or restFullData.image1.endsWith('png') or restFullData.image1.endsWith('PNG') or restFullData.image1.endsWith('gif'))}">
						<img th:src="@{|/restaurant/storage/${restFullData.image1}|}" style="width: 120px; height: 100px;">
					</div>
					<div class="restinfo">
						<span th:text="${restFullData.name}"></span><br>
						<div class="stars">
							<div class="full-stars" style="width: calc(${restFullData.rate} * 20%);"></div>
						</div>
						<span class="rest-area" th:text="'서울시 강남구'"></span><br>
						<span class="ranking" th:text="' ' + (${iterStat.index} + 1 +'위')"></span> <!-- Add this line for ranking -->
					</div>
				</div>
			</div>
			<script>
				const wrapHorizontal = document.getElementById('wrap-horizontal');

				let isDown = false;
				let startX;
				let scrollLeft;

				wrapHorizontal.addEventListener('mousedown', (e) => {
					isDown = true;
					wrapHorizontal.classList.add('active');
					startX = e.pageX - wrapHorizontal.offsetLeft;
					scrollLeft = wrapHorizontal.scrollLeft;
				});

				wrapHorizontal.addEventListener('mouseleave', () => {
					isDown = false;
					wrapHorizontal.classList.remove('active');
				});

				wrapHorizontal.addEventListener('mouseup', () => {
					isDown = false;
					wrapHorizontal.classList.remove('active');
				});

				wrapHorizontal.addEventListener('mousemove', (e) => {
					if (!isDown) return;
					e.preventDefault();
					const x = e.pageX - wrapHorizontal.offsetLeft;
					const walk = (x - startX) * 3; // Adjust scroll speed
					smoothScroll(wrapHorizontal, scrollLeft - walk);
				});

				function smoothScroll(element, target) {
					let start = element.scrollLeft;
					let change = target - start;
					let duration = 300;
					let startTime = performance.now();

					function animateScroll(currentTime) {
						let time = currentTime - startTime;
						let val = easeInOutQuad(time, start, change, duration);
						element.scrollLeft = val;
						if (time < duration) {
							requestAnimationFrame(animateScroll);
						}
					}
					requestAnimationFrame(animateScroll);
				}

				function easeInOutQuad(t, b, c, d) {
					t /= d / 2;
					if (t < 1) return c / 2 * t * t + b;
					t--;
					return -c / 2 * (t * (t - 2) - 1) + b;
				}

			</script>
    </section>
    <section id="section1">
        <h2>주변인기 식당</h2>
        <div id="wrap-vertical">
            <div class="image-container">
            	<img src="/images/1.jpg" alt="Image 1">
            	<div class="restinfo">
            		식당명<br>평점:5.0<span class="rest-area">서울시 강남구</span>
            	</div>
            </div>
            <div class="image-container">
            	<img src="/images/1.jpg" alt="Image 1">
            	<div class="restinfo">
            		식당명<br>평점:5.0<span class="rest-area">서울시 강남구</span>
            	</div>
            </div>
            <div class="image-container">
            	<img src="/images/1.jpg" alt="Image 1">
            	<div class="restinfo">
            		식당명<br>평점:5.0<span class="rest-area">서울시 강북구</span>
            	</div>
            </div>
            <div class="image-container">
            	<img src="/images/1.jpg" alt="Image 1">
            	<div>
            		식당명<br>평점:5.0<span class="rest-area">서울시 구로구</span>
            	</div>
            </div>
        </div>
    </section><section id="section1">
        <h2><식재료>취향저격 식당</h2>
        <div id="wrap-vertical">
            <div class="image-container">
            	<img src="/images/1.jpg" alt="Image 1">
            	<div class="restinfo">
            		식당명<br>평점:5.0<span class="rest-area">서울시 강남구</span>
            	</div>
            </div>
            <div class="image-container">
            	<img src="/images/1.jpg" alt="Image 1">
            	<div class="restinfo">
            		식당명<br>평점:5.0<span class="rest-area">서울시 강남구</span>
            	</div>
            </div>
            <div class="image-container">
            	<img src="/images/1.jpg" alt="Image 1">
            	<div class="restinfo">
            		식당명<br>평점:5.0<span class="rest-area">서울시 강북구</span>
            	</div>
            </div>
            <div class="image-container">
            	<img src="/images/1.jpg" alt="Image 1">
            	<div>
            		식당명<br>평점:5.0<span class="rest-area">서울시 구로구</span>
            	</div>
            </div>
        </div>
    </section>
    <script src="/js/restaurant/main_page/ImageSlide.js"></script>
    <script src="/js/area/SelectMidArea.js"></script>
    <script src="/js/today.js"></script>
	    <script>
		
		
		
		function selectBotarea(eventButton){
			let selected_botarea_btn = eventButton;
			let today = new Date();
			let year = today.getFullYear();
			let month = String(today.getMonth() + 1).padStart(2, '0');
			let date = String(today.getDate() + 1).padStart(2, '0');
			let full_date = year + "-" + month + "-" + date;
			if(selected_botarea_btn.value == 0){
				let all_botarea_button = document.getElementById('botarea_div').querySelectorAll('button');
				let botareaList = ""; 
				for(const button of all_botarea_button){
					if(button.value != 0){
						botareaList += button.value + "_";
					}
				}
				location.href="/restaurant/search_list?person=2&date=" + full_date + "&time=6&botareas=" + botareaList + "&categoryno=&min_price=0&max_price=40";
			}else{
				location.href="/restaurant/search_list?person=2&date=" + full_date + "&time=6&botareas=" + selected_botarea_btn.value + "&categoryno=&min_price=0&max_price=40";
			}
			
		}
		
		function selectCategory(categoryno){
			
			let today = new Date();
			let year = today.getFullYear();
			let month = String(today.getMonth() + 1).padStart(2, '0');
			let date = String(today.getDate() + 1).padStart(2, '0');
			let full_date = year + "-" + month + "-" + date;
			
			location.href="/restaurant/search_list?person=2&date=" + full_date + "&time=6&botareas=&categoryno=" + categoryno + "&min_price=0&max_price=40";

			
		}
	</script>
</div>

</html>