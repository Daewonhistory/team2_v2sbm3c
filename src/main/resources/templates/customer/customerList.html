<!DOCTYPE html>
<html layout:decorate="~{layout}">

<div layout:fragment="content">
  <div class='title_line'>회원(관리자 전용)</div>
  <aside class="aside_right">
    <a href="javascript:location.reload();">새로고침</a>
    <span class='menu_divide'>│</span>
    <a href='./create'>회원 가입</a>
    <span class='menu_divide'>│</span>
    <a href='./list.do'>목록</a>
    <div class='menu_line'></div>
  </aside>

  <table class="table table-striped" style='width: 100%;'>
    <colgroup>
      <col style='width: 5%;'/>
      <col style='width: 10%;'/>
      <col style='width: 15%;'/>
      <col style='width: 15%;'/>
      <col style='width: 30%;'/>
      <col style='width: 15%;'/>
      <col style='width: 10%;'/>
    </colgroup>
    <tr>
      <th class='th_bs'></th>
      <th class='th_bs'>ID</th>
      <th class='th_bs'>성명</th>
      <th class='th_bs'>전화번호</th>
      <th class='th_bs'>주소</th>
      <th class='th_bs'>등록일</th>
      <th class='th_bs'></th>
    </tr>

    <tr th:each="customerVO, status:${list}">
      <td>
      <div th:if="${customerVO.grade}">
        <div th:if="*{customerVO.grade == 1}">
          <a th:href="@{|./update_grade?custno=${customerVO.custno}|}">  <img src='/member/images/admin.png' title="관리자" class="icon"></a>
        </div>

      </div>
      </td>
      <td class='td_left'><a th:href="@{|./read?custno=${customerVO.custno}|}" th:text="${customerVO.id}"></a></td>
      <td class='td_left'><a th:href="@{|./read?custno=${customerVO.custno}|}" th:text="${customerVO.cname}"></a></td>
      <td class='td_basic' th:text="${customerVO.phone}"></td>
      <td class='td_left'>
        <span th:if="${customerVO.address1.length() > 15 }" th:text="${customerVO.address1.substring(0, 15) }"></span>
        <span th:unless="${customerVO.address1.length() > 15 }" th:text="${customerVO.address1}"></span>
      </td>
      <td class='td_basic' th:text="${customerVO.reg_date.substring(0, 10)}"></td>
      <td class='td_basic'>
        <a th:href="@{|./read?custno=${customerVO.custno}|}"><img src='/member/images/update.png' title='수정' class="icon"></a>
        <a th:attr="onclick=|deletecate('${customerVO.custno}','${customerVO.cname}')|"><img src='/member/images/delete.png' title='삭제' class="icon"></a>
        <a th:href="@{|./update_grade?custno=${customerVO.custno}|}"><img src='/member/images/grade.png' title='등급 수정' class="icon"></a>
      </td>
    </tr>
  </table>
  <script>
    function deletecate(custno, membername) {
      var name = membername; // cateVO.name 값 가져오기

      if (confirm(name + " 님을 탈퇴 처리하시겠습니까? 삭제하면 복구할 수 없습니다!")) {
        var form = document.createElement('form');
        form.method = 'post';
        form.action = '/member/delete' ;
        var hiddenField5 = document.createElement('input');
        hiddenField5.type = 'hidden';
        hiddenField5.name = 'custno'; // 서버에서 사용할 변수 이름
        hiddenField5.value = custno;
        form.appendChild(hiddenField5);

        var hiddenField6 = document.createElement('input');
        hiddenField6.type = 'hidden';
        hiddenField6.name = 'cname'; // 서버에서 사용할 변수 이름
        hiddenField6.value = name;
        form.appendChild(hiddenField6);
        document.body.appendChild(form);
        form.submit();
      } else {
        alert("원래 페이지로 돌아갑니다.");
      }
    }
  </script>
  <div class='bottom_menu'>

    <button type='button' onclick="location.reload();" class="btn btn-primary btn-sm">새로 고침</button>
  </div>

</div>


</html>
