<!DOCTYPE html>

<html layout:decorate="~{layout}"> <!-- layout.html 상속-->
<div layout:fragment="content">

  <div class='title_line'>전체 리뷰 목록</div> 
  
  <aside class="aside_right">
    <span>
      <a th:href="@{|/review/create?word=${word}&now_page=${now_page}|}">등록</a>
      <span class="menu_devide">│</span>
    </span>
    
    <a href="javascript:location.reload();">새로고침</a>
    
  </aside> 
   
  <div class='menu_line'></div>
       
  <table class="table table-striped" style='width: 100%;'>
    <colgroup>
      <col style='width: 10%;'/>
   
      <col style='width: 45%;'/>
      <col style='width: 5%;'/>
      <col style='width: 15%;'/>
      <col style='width: 5%;'/>
    </colgroup>
    <tr>
      <th class='th_bs'>번호</th>
  
      <th class='th_bs'>내용</th>
      <th class='th_bs'>평점</th>
      <th class='th_bs'>날짜</th>
      <th class='th_bs'>수정/삭제</th>
    </tr>
   
    <tr th:each="reviewDTO:${list}" 
         >
      <td class='td_basic' th:text="${reviewDTO.reviewno}"></td>
      <td class='td_left'>
        <span th:if="${reviewDTO.content.length() > 160 }" 
                  th:text="|${reviewDTO.content.substring(0, 160) }...|"></span>
        <span th:if="${reviewDTO.content.length() <= 160 }" 
                  th:text="|${reviewDTO.content}|"></span>
                  
      </td>
        
     
      <td class="td_bs">

      
      <td class='td_basic' th:text="${reviewDTO.rate}"></td>
      <td class='td_basic' th:text="${reviewDTO.rdate}"></td>
      
      <td class="td_bs">
          <a th:href="@{|/review/update?reviewno=${reviewDTO.reviewno}|}"><img src="/cate/images/update.png" class="icon"></a>
          <a th:attr="onclick=|delete_check(${reviewDTO.reviewno})|"><img src="/cate/images/delete.png" class="icon"></a>
      </td>
      
      <td th:if="${reviewDTO.image1 != null and (reviewDTO.image1.endsWith('jpg') or reviewDTO.image1.endsWith('JPG') or reviewDTO.image1.endsWith('png') or reviewDTO.image1.endsWith('PNG') or reviewDTO.image1.endsWith('gif'))}">
        <!--/*@thymesVar id="certifi_image" type=""*/-->
        <img th:src="@{|/review/storage/${reviewDTO.image1}|}" style="width: 120px; height: 90px;">
      </td>

      <td th:if="${reviewDTO.image2 != null and (reviewDTO.image2.endsWith('jpg') or reviewDTO.image2.endsWith('JPG') or reviewDTO.image2.endsWith('png') or reviewDTO.image2.endsWith('PNG') or reviewDTO.image2.endsWith('gif'))}">
        <!--/*@thymesVar id="certifi_image" type=""*/-->
        <img th:src="@{|/review/storage/${reviewDTO.image2}|}" style="width: 120px; height: 90px;">
      </td>
      <td th:if="${reviewDTO.image3 != null and (reviewDTO.image3.endsWith('jpg') or reviewDTO.image3.endsWith('JPG') or reviewDTO.image3.endsWith('png') or reviewDTO.image3.endsWith('PNG') or reviewDTO.image3.endsWith('gif'))}">
        <!--/*@thymesVar id="certifi_image" type=""*/-->
        <img th:src="@{|/review/storage/${reviewDTO.image3}|}" style="width: 120px; height: 90px;">
      </td>
    </tr>
  </table>
   
  <div class='bottom_menu'>
    <button type='button' onclick="location.reload();" class="btn btn-primary btn-sm">새로 고침</button>
  </div>

</div>
</html>

<script>
    function delete_check(reviewno){
      if (confirm("정말 삭제하시겠습니까??") == true){    //확인
        let f = document.createElement('form');
    
        let obj1;
        obj1 = document.createElement('input');
        obj1.type = 'hidden';
        obj1.name = 'reviewno';
        obj1.value = reviewno;
     
    
        f.appendChild(obj1);
        f.setAttribute('method', 'post');
        f.setAttribute('action', '/review/delete');
        document.body.appendChild(f);
        f.submit();
      }else{   //취소
          return;
      }
  }
  </script>
  
  <!-- 페이지 버튼 목록 출력 시작 -->
  <div class="Bottom_menu" th:utext="${paging}"></div>
</div>

