<!DOCTYPE html>

<html layout:decorate="~{layout}"> <!-- layout.html 상속-->
<div layout:fragment="content">

  <div class='title_line'>전체 리뷰 목록</div> 
  
  <aside class="aside_right">
    <span>
      <a th:href="@{|/review/create?reviewno=${reviewVO.reviewno}|}">등록</a>
      <span class="menu_devide">│</span>
    </span>
    
    <a href="javascript:location.reload();">새로고침</a>
  </aside> 
   
  <div class='menu_line'></div>
       
  <table class="table table-striped" style='width: 100%;'>
    <colgroup>
      <col style='width: 10%;'/>
      <col style='width: 20%;'/>
      <col style='width: 45%;'/>
      <col style='width: 5%;'/>
      <col style='width: 15%;'/>
      <col style='width: 5%;'/>
    </colgroup>
    <tr>
      <th class='th_bs'>번호</TH>
      <th class='th_bs'>제목</th>
      <th class='th_bs'>내용</th>
      <th class='th_bs'>평점</th>
      <th class='th_bs'>날짜</th>
      <th class='th_bs'>수정/삭제</th>
    </tr>
   
    <tr th:each="reviewVO:${list}" 
         >
      <td class='td_basic' th:text="${reviewVO.reviewno}"></td>
      <td class='td_basic' th:text="${reviewVO.title}"th:attr="onclick=|location.href='/review/read?reviewno=${reviewVO.reviewno}&custno=${reviewVO.custno}&restno=${reviewVO.restno}'|"
         style="cursor: pointer;"></td>
      <td class='td_left'>
        <span th:if="${reviewVO.content.length() > 160 }" 
                  th:text="|${reviewVO.content.substring(0, 160) }...|"></span>
        <span th:if="${reviewVO.content.length() <= 160 }" 
                  th:text="|${reviewVO.content}|"></span>
                  
      
     

      </td>
      
      <td class='td_basic' th:text="${reviewVO.rate}"></td>
      <td class='td_basic' th:text="${reviewVO.rdate}"></td>
      
      <td class="td_bs">
          <a th:href="@{|/review/update?reviewno=${reviewVO.reviewno}|}"><img src="/cate/images/update.png" class="icon"></a>
          <a th:attr="onclick=|delete_check(${reviewVO.reviewno})|"><img src="/cate/images/delete.png" class="icon"></a>
      </td>
    </tr>
  </table>
   
  <div class='bottom_menu'>
    <button type='button' onclick="location.reload();" class="btn btn-primary btn-sm">새로 고침</button>
  </div>

</div>
</html>

<script>
    function delete_check(reviewno){
      if (confirm("정말 삭제하시겠습니까??") == true){    //확인
        let f = document.createElement('form');
    
        let obj1;
        obj1 = document.createElement('input');
        obj1.type = 'hidden';
        obj1.name = 'reviewno';
        obj1.value = reviewno;
     
    
        f.appendChild(obj1);
        f.setAttribute('method', 'post');
        f.setAttribute('action', '/review/delete');
        document.body.appendChild(f);
        f.submit();
      }else{   //취소
          return;
      }
  }
  </script>

