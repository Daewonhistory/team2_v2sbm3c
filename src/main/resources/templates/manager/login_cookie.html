<!DOCTYPE html>

<html layout:decorate="~{layout}"> <!-- layout.html 상속-->

<div layout:fragment="content" class="form-container">

  <div class="form-wrapper">
    <h2 class="form-title">관리자 로그인</h2>
    <div class="fail-message" th:text="${fail}"></div>

    <form id="frm" name="frm" th:object="${manager}" method="post" action="/manager/login">
      <label class="form-label">아이디(이메일)* </label>
      <div style="display: flex; align-items: center;">
        <input type="text" name="id" id="id" value="admin1234" class="form-input" placeholder="아이디 입력" required>
      </div>
      <label style="margin-left: 10px;">
        <input type="checkbox" name="id_save" id="id_save" th:checked="${ck_id_save == 'Y'}" value="Y"/> 아이디 저장
      </label>
      <div id="id_msg" class="form-msg"></div>

      <label class="form-label" style="margin-top: 10px;">비밀번호* </label>
      <div style="display: flex; align-items: center;">
        <input type="password" name="passwd" id="passwd" value="1234" class="form-input" placeholder="비밀번호 입력" required>
      </div>
      <label style="margin-left: 10px;">
        <input type="checkbox" name="passwd_save" id="passwd_save" th:checked="${ck_passwd_save == 'Y'}" value="Y"/> 비밀번호 저장
      </label>
      <div id="passwd_msg" class="form-msg"></div>

      <div class="form-buttons" style="margin-top: 10px;">
        <button type="button" class="btn-submit" onclick="return send()" id="btn_send">로그인</button>
        <button type="button" class="btn-cancel" onclick="location.href = '/';" id="btn_cancel">취소</button>
      </div>
    </form>
  </div>
  <script>
    window.onload = function () {
      document.querySelector('#id').addEventListener('keypress', (event) => {
        let id = document.getElementById('id').value;
        if (id !== "" && event.key === 'Enter') {
          document.getElementById('passwd').focus();
        }
      });

      document.querySelector('#passwd').addEventListener('keypress', (event) => {
        let passwd = document.getElementById('passwd').value.trim();
        if (passwd !== "" && event.key === 'Enter') {
          document.getElementById('btn_send').focus();
        }
      });
    };

    function send() { // 회원 가입 처리
      let id = document.getElementById('id').value;
      let idfocus = document.getElementById('id');
      let id_msg = document.getElementById('id_msg');

      if (id == null || id.trim() == null) {
        alert('ID를 입력해주세요');
        return false;
      }

      if (id.trim().length == 0) {
        id_msg.style.fontSize = "12px";
        id_msg.innerHTML = 'ID가 누락되었습니다. ID 입력은 필수 입니다.';
        id_msg.classList.add('span_warning');    // class 적용
        idfocus.focus();
        return false;
      }

      if (id.trim().length < 4) {
        id_msg.innerHTML = ' ID(이메일)는 3자이상 권장합니다.';
        id_msg.style.marginTop = "5px";
        id_msg.classList.add('span_warning');    // class 적용
        idfocus.focus();
        return false;
      }

      let passwd = document.getElementById('passwd').value;
      if (passwd == null || passwd.trim() == null) {
        alert('비밀번호를  입력해주세요');
        return false;
      }

      if (passwd.trim().length == 0) {
        alert('패스워드가 누락되었습니다. 패스워드는 입력은 필수 입니다.');
        return false;
      }

      document.getElementById('frm').submit(); // required="required" 작동 안됨.
    }
  </script>

</div>

