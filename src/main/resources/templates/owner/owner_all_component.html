<!DOCTYPE html>
<div th:fragment="owner_all_fragment"> <!-- <div th:replace=...-->


  <script>
    document.addEventListener("DOMContentLoaded", function() {
      // 페이지가 로드된 후 카테고리 번호 값을 가져오기
      var categorynoElement = document.getElementById("categoryno");
      if (categorynoElement) {
        var categoryno = categorynoElement.innerText;

        // fetch API를 사용하여 AJAX 요청 보내기
        fetch(`/category/catelist_no?categoryno=${categoryno}`)
            .then(response => {
              if (!response.ok) {
                throw new Error('네트워크 응답이 올바르지 않습니다.');
              }
              return response.json();
            })
            .then(data => {
              // 성공적으로 응답을 받은 경우
              console.log('성공:', data);
              var categorynameElement = document.getElementById("categoryname");
              categorynameElement.innerText = data[0].name;
              // 필요한 경우 여기서 UI 업데이트 등 추가 작업을 수행할 수 있습니다.
            })
            .catch(error => {
              // 오류가 발생한 경우
              console.log('오류:', error);
            });
      } else {
        console.log("카테고리 번호 요소를 찾을 수 없습니다.");
      }
    });
  </script>

  <table class="table table-striped" >
    <colgroup>
      <col style='width: 10%;'/>
      <col style='width: 15%;'/>
      <col style='width: 15%;'/>
      <col style='width: 10%;'/>

      <col style='width: 10%;'/>
      <col style='width: 10%;'/>
      <col style='width: 10%;'/>
    </colgroup>
    <thead>
    <tr>
      <th class="th_bs">식당이름</th>
      <th style="display: none;" class="th_bs">카테고리번호</th>
      <th class="th_bs">카테고리이름</th>

      <th class="th_bs">사업자번호</th>


      <th class="th_bs">사진1</th>
      <th class="th_bs">사진2</th>

      <th class="th_bs">사진3</th>

    </tr>
    </thead>
    <tbody>




    <!-- Iterate over your data -->
    <tr th:each="restDTO : ${searchlist}">


      <td class="td_bs">
        <a th:href="@{|/owner/restread?restno=${restDTO.restno}|}" th:text="${restDTO.name}" style="display: block;"></a>
      </td>
      <td style="display: none;" class="td_bs"  th:text="${restDTO.categoryno}" id="categoryno"></td>
      <td class="td_bs"  id="categoryname"></td>

      <td class="td_bs"  th:text="${restDTO.ownerno}" id="ownerno"></td>

      <td th:if="${restDTO.image1 != null and (restDTO.image1.endsWith('jpg') or restDTO.image1.endsWith('JPG') or restDTO.image1.endsWith('png') or restDTO.image1.endsWith('PNG') or restDTO.image1.endsWith('gif'))}">
        <!--/*@thymesVar id="certifi_image" type=""*/-->
        <img th:src="@{|/restaurant/storage/${restDTO.image1}|}" style="width: 120px; height: 90px;">
      </td>

      <td th:if="${restDTO.image2 != null and (restDTO.image2.endsWith('jpg') or restDTO.image2.endsWith('JPG') or restDTO.image2.endsWith('png') or restDTO.image2.endsWith('PNG') or restDTO.image2.endsWith('gif'))}">
        <!--/*@thymesVar id="certifi_image" type=""*/-->
        <img th:src="@{|/restaurant/storage/${restDTO.image2}|}" style="width: 120px; height: 90px;">
      </td>
      <td th:if="${restDTO.image3 != null and (restDTO.image3.endsWith('jpg') or restDTO.image3.endsWith('JPG') or restDTO.image3.endsWith('png') or restDTO.image3.endsWith('PNG') or restDTO.image3.endsWith('gif'))}">
        <!--/*@thymesVar id="certifi_image" type=""*/-->
        <img th:src="@{|/restaurant/storage/${restDTO.image3}|}" style="width: 120px; height: 90px;">
      </td>
      <td class="td_bs">


        <a href="#" style="text-decoration: none" class="animate__slideOutDown"
           th:attr="onclick=|upbackward('${restDTO.restno}','${restDTO.name}')|">
          <img src="/cate/images/decrease.png" class="icon">

        </a>


        <a style="text-decoration: none" href="#" th:attr="onclick=|upforward('${restDTO.restno}','${restDTO.name}','${word}','${type}','${now_page}' )|">
          <img src="/cate/images/increase.png" class="icon">
        </a>
        <a style="text-decoration: none" th:href="@{'/cate/update/' + ${restDTO.restno}+ '?word='+${word} + '&now_page='+${now_page}+'&type='+${type}}">
          <img src="/cate/images/update.png" class="icon">
        </a>

        <a style="text-decoration: none" href="#" th:attr="onclick=|deleterest('${restDTO.restno}','${restDTO.name}','${word}','${type}','${now_page}' )|">
          <img src="/cate/images/delete.png" class="icon">
        </a>
        <script>
            function deleterest(restno, restname, word, type,now_page,num) {
                var name = restname; // restDTO.name 값 가져오기

                if (confirm(restno + "번의 " + name + " 중분류를 삭제하시겠습니까? 삭제하면 복구할 수 없습니다!")) {
                    var form = document.createElement('form');
                    form.method = 'post';
                    form.action = '/owner/delete?restno='+restno;
                    var hiddenField2 = document.createElement('input');
                    hiddenField2.type = 'hidden';
                    hiddenField2.name = 'word'; // 서버에서 사용할 변수 이름
                    hiddenField2.value = word;
                    form.appendChild(hiddenField2);
                    var hiddenField3 = document.createElement('input');
                    hiddenField3.type = 'hidden';
                    hiddenField3.name = 'type'; // 서버에서 사용할 변수 이름
                    hiddenField3.value = type;
                    form.appendChild(hiddenField3);
                    var hiddenField4 = document.createElement('input');
                    hiddenField4.type = 'hidden';
                    hiddenField4.name = 'now_page'; // 서버에서 사용할 변수 이름
                    hiddenField4.value = now_page;
                    form.appendChild(hiddenField4);
                    var hiddenField5 = document.createElement('input');
                    hiddenField5.type = 'hidden';
                    hiddenField5.name = 'num'; // 서버에서 사용할 변수 이름
                    hiddenField5.value = num;
                    form.appendChild(hiddenField5);

                    var hiddenField6 = document.createElement('input');
                    hiddenField6.type = 'hidden';
                    hiddenField6.name = 'name'; // 서버에서 사용할 변수 이름
                    hiddenField6.value = name;
                    form.appendChild(hiddenField6);
                    document.body.appendChild(form);
                    form.submit();
                } else {
                    alert("원래 페이지로 돌아갑니다.");
                }
            }
        </script>
        <script>
            function upforward(categoryno, catename, word, type,now_page,num) {
                var name = catename; // restDTO.name 값 가져오기

                if (confirm(num + "번의 " + name + " 중분류의 순서를 하나 올리겠습니까?")) {
                    var form = document.createElement('form');
                    form.method = 'post';
                    form.action = '/cate/upforward/' + categoryno;
                    var hiddenField2 = document.createElement('input');
                    hiddenField2.type = 'hidden';
                    hiddenField2.name = 'word'; // 서버에서 사용할 변수 이름
                    hiddenField2.value = word;
                    form.appendChild(hiddenField2);
                    var hiddenField3 = document.createElement('input');
                    hiddenField3.type = 'hidden';
                    hiddenField3.name = 'type'; // 서버에서 사용할 변수 이름
                    hiddenField3.value = type;
                    form.appendChild(hiddenField3);
                    var hiddenField4 = document.createElement('input');
                    hiddenField4.type = 'hidden';
                    hiddenField4.name = 'now_page'; // 서버에서 사용할 변수 이름
                    hiddenField4.value = now_page;
                    form.appendChild(hiddenField4);
                    var hiddenField5 = document.createElement('input');
                    hiddenField5.type = 'hidden';
                    hiddenField5.name = 'num'; // 서버에서 사용할 변수 이름
                    hiddenField5.value = num;
                    form.appendChild(hiddenField5);

                    var hiddenField6 = document.createElement('input');
                    hiddenField6.type = 'hidden';
                    hiddenField6.name = 'name'; // 서버에서 사용할 변수 이름
                    hiddenField6.value = name;
                    form.appendChild(hiddenField6);
                    document.body.appendChild(form);
                    form.submit();
                } else {
                    alert("원래 페이지로 돌아갑니다.");

                }
            }
        </script>

        <script>
            function upbackward(categoryno, catename, word, type,now_page,num) {
                var name = catename; // restDTO.name 값 가져오기

                if (confirm(num + "번의 " + name + " 중분류의 순서를 하나 내리겠습니까?")) {
                    var form = document.createElement('form');
                    form.method = 'post';
                    form.action = '/cate/upbackward/' + categoryno;
                    var hiddenField2 = document.createElement('input');
                    hiddenField2.type = 'hidden';
                    hiddenField2.name = 'word'; // 서버에서 사용할 변수 이름
                    hiddenField2.value = word;
                    form.appendChild(hiddenField2);
                    var hiddenField3 = document.createElement('input');
                    hiddenField3.type = 'hidden';
                    hiddenField3.name = 'type'; // 서버에서 사용할 변수 이름
                    hiddenField3.value = type;
                    form.appendChild(hiddenField3);
                    var hiddenField4 = document.createElement('input');
                    hiddenField4.type = 'hidden';
                    hiddenField4.name = 'now_page'; // 서버에서 사용할 변수 이름
                    hiddenField4.value = now_page;
                    form.appendChild(hiddenField4);
                    var hiddenField5 = document.createElement('input');
                    hiddenField5.type = 'hidden';
                    hiddenField5.name = 'num'; // 서버에서 사용할 변수 이름
                    hiddenField5.value = num;
                    form.appendChild(hiddenField5);

                    var hiddenField6 = document.createElement('input');
                    hiddenField6.type = 'hidden';
                    hiddenField6.name = 'name'; // 서버에서 사용할 변수 이름
                    hiddenField6.value = name;
                    form.appendChild(hiddenField6);
                    document.body.appendChild(form);
                    form.submit();
                } else {
                    alert("원래 페이지로 돌아갑니다.");

                }
            }
        </script>


        <script>
            function show(categoryno, catename, word, type,now_page,num) {
                var name = catename; // restDTO.name 값 가져오기

                if (confirm(num + "번의 " + name + " 중분류의 공개 처리 하겠습니까?")) {
                    var form = document.createElement('form');
                    form.method = 'post';
                    form.action = '/cate/show/' + categoryno;
                    var hiddenField2 = document.createElement('input');
                    hiddenField2.type = 'hidden';
                    hiddenField2.name = 'word'; // 서버에서 사용할 변수 이름
                    hiddenField2.value = word;
                    form.appendChild(hiddenField2);
                    var hiddenField3 = document.createElement('input');
                    hiddenField3.type = 'hidden';
                    hiddenField3.name = 'type'; // 서버에서 사용할 변수 이름
                    hiddenField3.value = type;
                    form.appendChild(hiddenField3);
                    var hiddenField4 = document.createElement('input');
                    hiddenField4.type = 'hidden';
                    hiddenField4.name = 'now_page'; // 서버에서 사용할 변수 이름
                    hiddenField4.value = now_page;
                    form.appendChild(hiddenField4);
                    var hiddenField5 = document.createElement('input');
                    hiddenField5.type = 'hidden';
                    hiddenField5.name = 'num'; // 서버에서 사용할 변수 이름
                    hiddenField5.value = num;
                    form.appendChild(hiddenField5);

                    var hiddenField6 = document.createElement('input');
                    hiddenField6.type = 'hidden';
                    hiddenField6.name = 'name'; // 서버에서 사용할 변수 이름
                    hiddenField6.value = name;
                    form.appendChild(hiddenField6);
                    document.body.appendChild(form);
                    form.submit();
                } else {
                    alert("원래 페이지로 돌아갑니다.");

                }
            }
        </script>

        <script>
            function hide(categoryno, catename, word, type,now_page,num) {

                var name = catename; // restDTO.name 값 가져오기

                if (confirm(num + "번의 " + name + " 중분류의 숨김 처리 하겠습니까?")) {
                    var form = document.createElement('form');
                    form.method = 'post';
                    form.action = '/cate/hide/' + categoryno;
                    var hiddenField2 = document.createElement('input');
                    hiddenField2.type = 'hidden';
                    hiddenField2.name = 'word'; // 서버에서 사용할 변수 이름
                    hiddenField2.value = word;
                    form.appendChild(hiddenField2);
                    var hiddenField3 = document.createElement('input');
                    hiddenField3.type = 'hidden';
                    hiddenField3.name = 'type'; // 서버에서 사용할 변수 이름
                    hiddenField3.value = type;
                    form.appendChild(hiddenField3);
                    var hiddenField4 = document.createElement('input');
                    hiddenField4.type = 'hidden';
                    hiddenField4.name = 'now_page'; // 서버에서 사용할 변수 이름
                    hiddenField4.value = now_page;
                    form.appendChild(hiddenField4);
                    var hiddenField5 = document.createElement('input');
                    hiddenField5.type = 'hidden';
                    hiddenField5.name = 'num'; // 서버에서 사용할 변수 이름
                    hiddenField5.value = num;
                    form.appendChild(hiddenField5);

                    var hiddenField6 = document.createElement('input');
                    hiddenField6.type = 'hidden';
                    hiddenField6.name = 'name'; // 서버에서 사용할 변수 이름
                    hiddenField6.value = name;
                    form.appendChild(hiddenField6);
                    document.body.appendChild(form);
                    form.submit();
                } else {
                    alert("원래 페이지로 돌아갑니다.");

                }
            }
        </script>

      </td>
    </tr>
    </tbody>
  </table>



<!-- 페이지 버튼 목록 출력 시작 -->
</div>


